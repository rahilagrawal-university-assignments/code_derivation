\documentclass[a4paper,12pt,fleqn]{scrartcl}
\usepackage[l2tabu,orthodox]{nag}% Old habits die hard. All the same, there are commands, classes and packages which are outdated and superseded. nag provides routines to warn the user about the use of those.
\usepackage[all,error]{onlyamsmath}% Error on deprecated math commands like $$ $$.
\usepackage{fixltx2e}
\usepackage[strict=true]{csquotes}
\usepackage{listings}
\lstset{frame=single,framerule=0pt,language={C},showstringspaces=false,numbers=left,columns=fullflexible}
\usepackage{color}
\usepackage{2111defs2,2111theorems}
\usepackage{nicefrac}


\newcommand{\singlequote}[1]{`#1'}
\newcommand{\myjustification}[2][\Equiv]{{}#1{} &{\bcolor\langle\text{#2}\rangle}\\}
\newcommand{\remark}[1]{{\sffamily\color{blue}{#1}}}
\newcommand{\myImplies}[2]{\color{red}#1\color{blue}\Implies\color{red}#2\color{black}}
\newcommand{\pre}{\mathit{pre}}
\newcommand{\post}{\mathit{post}}
\newcommand{\emirp}{\textsc{emirp}\xspace}


\title{Assignment 2 - Emirps}
\date{COMP2111 18s1}
\author{Rahil Agrawal z5165505\\Aditya Karia zXXXXXXX}

\begin{document}
\pagenumbering{gobble}
\maketitle
\pagenumbering{Roman}

\section{Task 1 - Specification Statement}
\label{sec:task-1}
\remark{The spec}

\section{Task 2 - Derivation}
\label{sec:task-1}
\begin{align*}
  &\PROC~\emirp(\VALUE~n, \RESULT~r)\cdot{}\\
  &\qquad  \nt{n,r:\left[
    \begin{array}{l}
      n>0, Emirp(r,n)
    \end{array}
  \right]}{(1)}\\
% 
  \lrefstep{(1)}
  {\textbf{c-frame}}
  {
  \nt{r:\left[
    \begin{array}{l}
      n>0, Emirp(r,n)
    \end{array}
  \right]}{(2)}}\\
%
  \lrefstep{(2)}
  {\textbf{i-loc}}
  {
  \nt{i,r:\left[
    \begin{array}{l}
      n>0, Emirp(r,n)
    \end{array}
  \right]}{(3)}}\\
%
  \lrefstep{(3)}
  {\textbf{seq}}
  {
  \nt{i,r:\left[
    \begin{array}{l}
      n>0, i=0 \And n>0
    \end{array}
  \right]}{(4)};\\
  &\nt{i:\left[
    \begin{array}{l}
      i=0 \And n>0, Emirp(r,n)
    \end{array}
  \right]}{(5)}}\\
%
  \lrefstep{(4)}
  {\textbf{c-frame}}
  {
  \nt{i:\left[
    \begin{array}{l}
      n>0, i=1 \And n>0
    \end{array}
  \right]}{}}\\
%
  \refstep{\textbf{ass - \color{blue}(1)}}
  {i\Ass 1}\\
%
  \lrefstep{(5)}
  {\textbf{seq}}
  {
  \nt{i,r:\left[
    \begin{array}{l}
      i=1 \And n>0, Inv
    \end{array}
  \right]}{(6)};\\
  &\nt{i,r:\left[
    \begin{array}{l}
      Inv, Inv \And i=n
    \end{array}
  \right]}{(7)};\\
  &\nt{i,r:\left[
    \begin{array}{l}
      Inv \And i=n, Emirp(r,n)
    \end{array}
  \right]}{(8)}}\\
%
  \lrefstep{(6)}
  {\textbf{w-pre, c-frame - \color{blue}(2)}}
  {
  \nt{r:\left[
    \begin{array}{l}
      Inv\subst{13}{r}, Inv
    \end{array}
  \right]}{(9)}}\\
%
  \refstep{\textbf{ass - \color{blue}(3)}}
  {r\Ass 13}\\
%
  \lrefstep{(7)}
  {\textbf{while}}
  {
  \WHILE~i\neq n~\DO\\
  &\qquad \nt{i,r:\left[
    \begin{array}{l}
      Inv\And i\neq n, Inv
    \end{array}
  \right]}{(10)}\\
  &\OD;}\\
%
  \lrefstep{(10)}
  {\textbf{seq}}
  {
  \nt{r:\left[
    \begin{array}{l}
      Inv\And i\neq n, Inv\subst{r+1}{r}
    \end{array}
  \right]}{(11)};\\
  &\nt{r:\left[
    \begin{array}{l}
      Inv\subst{r+1}{r}, Inv
    \end{array}
  \right]}{(12)}}\\
\end{align*}
\begin{align*}
\lrefstep{(11)}
  {\textbf{i-loc}}
  {
  \nt{a,i,r:\left[
    \begin{array}{l}
      Inv\subst{r+1}{r}, Inv
    \end{array}
  \right]}{(13)}}\\
%
  \refstep{\textbf{if}}
  {\IF~l=r+1\\
  &\THEN~\nt{p:[l=r+1\And\pre(2),\post(2)]}{(3)}\\
  &\ELSE~\nt{p:[l\neq r+1\And\pre(2),\post(2)]}{(4)}\\
  &\FI}\\
%
\end{align*}
We gather the code for the procedure body of $\emirp$:
\begin{tabbing}% unfortunately, tabbing doesn't do maths

\end{tabbing}

\section{Task 3 - C Code}
\label{sec:task-1}
\lstinputlisting{emirp.c}

\end{document}
